import pytest

import ECHO
import numpy as np
from scipy.interpolate import interp1d


'''
Tests to make:

'''

def test_findpeak():
    f = np.linspace(50, 100, 51, endpoint=True)
    x = np.array([ 8.45090674, 10.04123532, 11.519111  , 11.31353706, 10.93862423,
       10.14809911, 10.56714626,  9.35886578,  8.95918093,  7.81729457,
        4.37170954,  7.56457857,  8.78697872, 12.04254699,  7.90141348,
        9.28847377,  9.65893591,  5.47728162, 11.4554848 ,  5.68049579,
       10.05662662, 13.03766057,  9.50115484,  7.63408106, 11.65752125,
        9.99689695,  9.83531587,  9.11961106,  8.2682244 , 11.24434912,
       12.93292398,  9.79594562,  8.22141003,  8.68508538,  8.50393763,
       10.83899931, 12.2772833 , 15.7622897 , 14.55045571,  9.2609078 ,
        9.0943069 ,  7.27017967, 12.93086491, 11.28801567,  7.95531201,
       11.79401846,  9.71806665,  8.5215067 ,  9.26962276, 13.13287041,
       10.83630832])
    maxfreq, peak, peakrms = ECHO.time_utils.find_peak(f, x,fmin=50, fmax=100)
    assert(maxfreq[0] == 87.), "Incorrect frequency."
    assert(peak == 15.7622897), "Incorrect peak value."
    return
